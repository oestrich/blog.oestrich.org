GIT_REPO=$HOME/repos/blog.oestrich.org
TMP_GIT_CLONE=$HOME/tmp/blog.oestrich.org
PUBLIC_WWW=$HOME/vhosts/blog.oestrich.org

unset GIT_DIR

if [ -d $TMP_GIT_CLONE ]; then
  cd $TMP_GIT_CLONE

  git pull origin master
else
  git clone $GIT_REPO $TMP_GIT_CLONE

  cd $TMP_GIT_CLONE
fi

bundle install --deployment
rm -rf $TMP_GIT_CLONE/vendor/bundle/ruby/1.9.1/gems/jekyll-0.11.2/test/source

bundle exec jekyll --no-auto $TMP_GIT_CLONE $PUBLIC_WWW

exit
